{"title": "分享丨【题单】字符串（KMP/Z函数/Manacher/字符串哈希/AC自动机/后缀数组/子序列自动机）", "src": "https://leetcode.cn/circle/discuss/SJFwQI", "last_update": "2025-01-29T06:29:56.804889+00:00", "children": [{"title": "介绍", "summary": "<img src=\"https://pic.leetcode.cn/1728350300-LGjhkL-Knuth-Morris-Pratt.png\" alt=\"Knuth-Morris-Pratt.png\" style=\"width: 100%;\"><br>", "isLeaf": false, "children": [{"title": "一、KMP", "summary": "定义 $s$ 的真前缀为不等于 $s$ 的前缀，$s$ 的真后缀为不等于 $s$ 的后缀。<br>定义 $s$ 的 $\\text{border}$ 为既是 $s$ 的真前缀又是 $s$ 的真后缀的字符串。例如在 $s=\\texttt{aabcaa}$ 中，$\\texttt{a}$ 和 $\\texttt{aa}$ 都是 $s$ 的 $\\text{border}$。<br>对于模式串 $p$ 的每个前缀 $p[:i]$，计算这个前缀的最长 $\\text{border}$ 长度，记在 $\\pi$ 数组中。<br>利用 $\\pi$ 数组，可以快速计算模式串 $p$ 出现在文本串 $t$ 的哪些位置上。代码模板见 <a href=\"https://leetcode.cn/problems/find-beautiful-indices-in-the-given-array-ii/solutions/2603695/kmper-fen-cha-zhao-by-endlesscheng-7bjm/\">我的题解</a>。<br>> 注：$\\pi$ 数组的定义参考《算法导论》，国内数据结构教材通常定义为 $\\textit{next}$ 数组。以严蔚敏那本为例，二者的关系是 $\\textit{next}[i+1] = \\pi[i]+1$，即 $\\pi$ 数组整体右移一位，元素值加一。<br>", "isLeaf": true, "children": [], "problems": [{"id": 28, "title": "28. 找出字符串中第一个匹配项的下标", "slug": "/find-the-index-of-the-first-occurrence-in-a-string/", "src": "https://leetcode.cn/problems/find-the-index-of-the-first-occurrence-in-a-string/", "solution": null, "score": null, "isPremium": false}, {"id": 796, "title": "796. 旋转字符串", "slug": "/rotate-string/", "src": "https://leetcode.cn/problems/rotate-string/", "solution": null, "score": 1167.0749837258, "isPremium": false}, {"id": 1392, "title": "1392. 最长快乐前缀", "slug": "/longest-happy-prefix/", "src": "https://leetcode.cn/problems/longest-happy-prefix/", "solution": null, "score": 1876.146019008, "isPremium": false}, {"id": 3036, "title": "3036. 匹配模式数组的子数组数目 II", "slug": "/number-of-subarrays-that-match-a-pattern-ii/", "src": "https://leetcode.cn/problems/number-of-subarrays-that-match-a-pattern-ii/", "solution": null, "score": 1894.5496928891, "isPremium": false}, {"id": 1764, "title": "1764. 通过连接另一个数组的子数组得到一个数组", "slug": "/form-array-by-concatenating-subarrays-of-another-array/", "src": "https://leetcode.cn/problems/form-array-by-concatenating-subarrays-of-another-array/", "solution": null, "score": 1588.3835994255, "isPremium": false}, {"id": 1668, "title": "1668. 最大重复子字符串", "slug": "/maximum-repeating-substring/", "src": "https://leetcode.cn/problems/maximum-repeating-substring/", "solution": null, "score": 1395.5132479177, "isPremium": false}, {"id": 459, "title": "459. 重复的子字符串", "slug": "/repeated-substring-pattern/", "src": "https://leetcode.cn/problems/repeated-substring-pattern/", "solution": null, "score": null, "isPremium": false}, {"id": 3008, "title": "3008. 找出数组中的美丽下标 II", "slug": "/find-beautiful-indices-in-the-given-array-ii/", "src": "https://leetcode.cn/problems/find-beautiful-indices-in-the-given-array-ii/", "solution": null, "score": 2016.2085876254, "isPremium": false}, {"id": 214, "title": "214. 最短回文串", "slug": "/shortest-palindrome/", "src": "https://leetcode.cn/problems/shortest-palindrome/", "solution": null, "score": null, "isPremium": false}, {"id": 686, "title": "686. 重复叠加字符串匹配", "slug": "/repeated-string-match/", "src": "https://leetcode.cn/problems/repeated-string-match/", "solution": null, "score": null, "isPremium": false}, {"id": 1397, "title": "1397. 找到所有好字符串", "slug": "/find-all-good-strings/", "src": "https://leetcode.cn/problems/find-all-good-strings/", "solution": null, "score": 2666.668150845, "isPremium": false}, {"id": 3037, "title": "3037. 在无限流中寻找模式 II", "slug": "/find-pattern-in-infinite-stream-ii/", "src": "https://leetcode.cn/problems/find-pattern-in-infinite-stream-ii/", "solution": null, "score": null, "isPremium": true}]}, {"title": "二、Z 函数（扩展 KMP）", "summary": "对于字符串 $s$，定义 $z[i]$ 表示后缀 $s[i:]$ 与 $s$ 的 LCP（最长公共前缀）的长度，其中 $s[i:]$ 表示从 $s[i]$ 到 $s[n-1]$ 的子串。<br>常用技巧是构造字符串 $\\textit{pattern}+\\textit{s}$，如果发现 $z[m+i]\\ge m$（$m$ 是 $\\textit{pattern}$ 的长度），则说明从 $s[i]$ 开始的子串与 $\\textit{pattern}$ 匹配。<br>所以上面的一些 KMP 题目（子串匹配相关的），也可以用 Z 函数解决。读者可以尝试用 Z 函数解决 <a href=\"https://leetcode.cn/problems/find-the-index-of-the-first-occurrence-in-a-string/\">28. 找出字符串中第一个匹配项的下标</a>。<br>**LCP 数组**<br>", "isLeaf": true, "children": [], "problems": [{"id": 2223, "title": "2223. 构造字符串的总得分和", "slug": "/sum-of-scores-of-built-strings/", "src": "https://leetcode.cn/problems/sum-of-scores-of-built-strings/", "solution": null, "score": 2220.0903365738, "isPremium": false}, {"id": 3031, "title": "3031. 将单词恢复初始状态所需的最短时间 II", "slug": "/minimum-time-to-revert-word-to-initial-state-ii/", "src": "https://leetcode.cn/problems/minimum-time-to-revert-word-to-initial-state-ii/", "solution": null, "score": 2277.9557248587, "isPremium": false}, {"id": 3045, "title": "3045. 统计前后缀下标对 II", "slug": "/count-prefix-and-suffix-pairs-ii/", "src": "https://leetcode.cn/problems/count-prefix-and-suffix-pairs-ii/", "solution": null, "score": 2327.5726642605, "isPremium": false}, {"id": 3303, "title": "3303. 第一个几乎相等子字符串的下标", "slug": "/find-the-occurrence-of-first-almost-equal-substring/", "src": "https://leetcode.cn/problems/find-the-occurrence-of-first-almost-equal-substring/", "solution": null, "score": 2509.3686325754, "isPremium": false}, {"id": 3292, "title": "3292. 形成目标字符串需要的最少字符串数 II", "slug": "/minimum-number-of-valid-strings-to-form-target-ii/", "src": "https://leetcode.cn/problems/minimum-number-of-valid-strings-to-form-target-ii/", "solution": null, "score": 2661.736901362, "isPremium": false}, {"id": 2430, "title": "2430. 对字母串可执行的最大删除数", "slug": "/maximum-deletions-on-a-string/", "src": "https://leetcode.cn/problems/maximum-deletions-on-a-string/", "solution": null, "score": 2101.867342004, "isPremium": false}, {"id": 3388, "title": "3388. 统计数组中的美丽分割", "slug": "/count-beautiful-splits-in-an-array/", "src": "https://leetcode.cn/problems/count-beautiful-splits-in-an-array/", "solution": null, "score": 2364.6818184488, "isPremium": false}, {"id": 1977, "title": "1977. 划分数字的方案数", "slug": "/number-of-ways-to-separate-numbers/", "src": "https://leetcode.cn/problems/number-of-ways-to-separate-numbers/", "solution": null, "score": 2817.267212602, "isPremium": false}]}, {"title": "三、Manacher 算法", "summary": "Manacher 算法可以计算以 $s[i]$（或者 $s[i]$ 和 $s[i+1]$）为回文中心的最长回文子串的长度。<br>此外，还可以：<br>- 判断任意子串是否为回文串。<br>- 计算从 $s[i]$ 开始的最长回文子串的长度。<br>- 计算以 $s[i]$ 结尾的最长回文子串的长度。<br>> Z 函数和 Manacher 算法都会用到类似 Z-box 的概念，在学习时，可以对比体会。<br>", "isLeaf": true, "children": [], "problems": [{"id": 5, "title": "5. 最长回文子串", "slug": "/longest-palindromic-substring/", "src": "https://leetcode.cn/problems/longest-palindromic-substring/", "solution": null, "score": null, "isPremium": false}, {"id": 647, "title": "647. 回文子串", "slug": "/palindromic-substrings/", "src": "https://leetcode.cn/problems/palindromic-substrings/", "solution": null, "score": null, "isPremium": false}, {"id": 214, "title": "214. 最短回文串", "slug": "/shortest-palindrome/", "src": "https://leetcode.cn/problems/shortest-palindrome/", "solution": null, "score": null, "isPremium": false}, {"id": 3327, "title": "3327. 判断 DFS 字符串是否是回文串", "slug": "/check-if-dfs-strings-are-palindromes/", "src": "https://leetcode.cn/problems/check-if-dfs-strings-are-palindromes/", "solution": null, "score": 2454.1900261902, "isPremium": false}, {"id": 1745, "title": "1745. 分割回文串 IV", "slug": "/palindrome-partitioning-iv/", "src": "https://leetcode.cn/problems/palindrome-partitioning-iv/", "solution": null, "score": 1924.964639491, "isPremium": false}, {"id": 1960, "title": "1960. 两个回文子字符串长度的最大乘积", "slug": "/maximum-product-of-the-length-of-two-palindromic-substrings/", "src": "https://leetcode.cn/problems/maximum-product-of-the-length-of-two-palindromic-substrings/", "solution": null, "score": 2690.5859406179, "isPremium": false}]}, {"title": "四、字符串哈希", "summary": "本题单的大多数题目都可以用字符串哈希解决。<br>推荐先把 <a href=\"https://leetcode.cn/problems/find-substring-with-given-hash-value/\">2156. 查找给定哈希值的子串</a> 做了，对理解**多项式哈希**的计算方法有帮助。<br>模板代码见 <a href=\"https://leetcode.cn/problems/construct-string-with-minimum-cost/solutions/2833949/hou-zhui-shu-zu-by-endlesscheng-32h9/\">我的题解</a>，包含单模哈希和双模哈希。<br>", "isLeaf": true, "children": [], "problems": [{"id": 28, "title": "28. 找出字符串中第一个匹配项的下标", "slug": "/find-the-index-of-the-first-occurrence-in-a-string/", "src": "https://leetcode.cn/problems/find-the-index-of-the-first-occurrence-in-a-string/", "solution": null, "score": null, "isPremium": false}, {"id": 187, "title": "187. 重复的 DNA 序列", "slug": "/repeated-dna-sequences/", "src": "https://leetcode.cn/problems/repeated-dna-sequences/", "solution": null, "score": null, "isPremium": false}, {"id": 1316, "title": "1316. 不同的循环子字符串", "slug": "/distinct-echo-substrings/", "src": "https://leetcode.cn/problems/distinct-echo-substrings/", "solution": null, "score": 1836.536348078, "isPremium": false}, {"id": 1297, "title": "1297. 子串的最大出现次数", "slug": "/maximum-number-of-occurrences-of-a-substring/", "src": "https://leetcode.cn/problems/maximum-number-of-occurrences-of-a-substring/", "solution": null, "score": 1748.1523771585, "isPremium": false}, {"id": 2261, "title": "2261. 含最多 K 个可整除元素的子数组", "slug": "/k-divisible-elements-subarrays/", "src": "https://leetcode.cn/problems/k-divisible-elements-subarrays/", "solution": null, "score": 1724.394164934, "isPremium": false}, {"id": 3213, "title": "3213. 最小代价构造字符串", "slug": "/construct-string-with-minimum-cost/", "src": "https://leetcode.cn/problems/construct-string-with-minimum-cost/", "solution": null, "score": 2170.7313528632, "isPremium": false}, {"id": 1367, "title": "1367. 二叉树中的链表", "slug": "/linked-list-in-binary-tree/", "src": "https://leetcode.cn/problems/linked-list-in-binary-tree/", "solution": null, "score": 1649.9728054796, "isPremium": false}, {"id": 1044, "title": "1044. 最长重复子串", "slug": "/longest-duplicate-substring/", "src": "https://leetcode.cn/problems/longest-duplicate-substring/", "solution": null, "score": 2428.7985254341, "isPremium": false}, {"id": 718, "title": "718. 最长重复子数组", "slug": "/maximum-length-of-repeated-subarray/", "src": "https://leetcode.cn/problems/maximum-length-of-repeated-subarray/", "solution": null, "score": null, "isPremium": false}, {"id": 1923, "title": "1923. 最长公共子路径", "slug": "/longest-common-subpath/", "src": "https://leetcode.cn/problems/longest-common-subpath/", "solution": null, "score": 2661.0670044656, "isPremium": false}, {"id": 3292, "title": "3292. 形成目标字符串需要的最少字符串数 II", "slug": "/minimum-number-of-valid-strings-to-form-target-ii/", "src": "https://leetcode.cn/problems/minimum-number-of-valid-strings-to-form-target-ii/", "solution": null, "score": 2661.736901362, "isPremium": false}, {"id": 2168, "title": "2168. 每个数字的频率都相同的独特子字符串的数量", "slug": "/unique-substrings-with-equal-digit-frequency/", "src": "https://leetcode.cn/problems/unique-substrings-with-equal-digit-frequency/", "solution": null, "score": null, "isPremium": true}, {"id": 1554, "title": "1554. 只有一个不同字符的字符串", "slug": "/strings-differ-by-one-character/", "src": "https://leetcode.cn/problems/strings-differ-by-one-character/", "solution": null, "score": null, "isPremium": true}, {"id": 1062, "title": "1062. 最长重复子串", "slug": "/longest-repeating-substring/", "src": "https://leetcode.cn/problems/longest-repeating-substring/", "solution": null, "score": null, "isPremium": true}]}, {"title": "五、最小表示法", "summary": "定义**循环左移**操作：把字符串 $s$ 的第一个字符 $s[0]$ 移除，添加到 $s$ 的末尾。例如 $\\texttt{abcd}$ 操作一次后得到 $\\texttt{bcda}$。<br>问题：你可以执行任意次循环左移操作，计算你能得到的字典序最小的字符串。<br>推荐先完成 <a href=\"https://leetcode.cn/problems/last-substring-in-lexicographical-order/\">1163. 按字典序排在最后的子串</a>，再做下面这题。<br>注：和 1163 相似的题目，还有 <a href=\"https://leetcode.cn/problems/find-the-lexicographically-largest-string-from-the-box-i/\">3403. 从盒子中找出字典序最大的字符串 I</a>。<br>", "isLeaf": true, "children": [], "problems": [{"id": 899, "title": "899. 有序队列", "slug": "/orderly-queue/", "src": "https://leetcode.cn/problems/orderly-queue/", "solution": null, "score": 2096.6098086765, "isPremium": false}]}, {"title": "六、字典树", "summary": "- 见 <a href=\"/lc-rating/list/data_structure\">数据结构题单</a> 第六章。<br>", "isLeaf": false, "children": [], "problems": []}, {"title": "七、AC 自动机", "summary": "AC 自动机 = 字典树 + KMP。<br>由于这些题目也可以用其他算法（字符串哈希等）解决，难度分仅供参考。<br>", "isLeaf": true, "children": [], "problems": [{"id": 1032, "title": "1032. 字符流", "slug": "/stream-of-characters/", "src": "https://leetcode.cn/problems/stream-of-characters/", "solution": null, "score": 1970.4608098164, "isPremium": false}, {"id": "面试题 17.17", "title": "面试题 17.17. 多次搜索", "slug": "/multi-search-lcci/", "src": "https://leetcode.cn/problems/multi-search-lcci/", "solution": null, "score": null, "isPremium": false}, {"id": 1408, "title": "1408. 数组中的字符串匹配", "slug": "/string-matching-in-an-array/", "src": "https://leetcode.cn/problems/string-matching-in-an-array/", "solution": null, "score": 1223.3861903833, "isPremium": false}, {"id": 3213, "title": "3213. 最小代价构造字符串", "slug": "/construct-string-with-minimum-cost/", "src": "https://leetcode.cn/problems/construct-string-with-minimum-cost/", "solution": null, "score": 2170.7313528632, "isPremium": false}, {"id": 3292, "title": "3292. 形成目标字符串需要的最少字符串数 II", "slug": "/minimum-number-of-valid-strings-to-form-target-ii/", "src": "https://leetcode.cn/problems/minimum-number-of-valid-strings-to-form-target-ii/", "solution": null, "score": 2661.736901362, "isPremium": false}]}, {"title": "八、后缀数组/后缀自动机", "summary": "由于这些题目也可以用其他算法（字符串哈希等）解决，难度分仅供参考。<br>", "isLeaf": true, "children": [], "problems": [{"id": 1163, "title": "1163. 按字典序排在最后的子串", "slug": "/last-substring-in-lexicographical-order/", "src": "https://leetcode.cn/problems/last-substring-in-lexicographical-order/", "solution": null, "score": 1864.0948676111, "isPremium": false}, {"id": 1754, "title": "1754. 构造字典序最大的合并字符串", "slug": "/largest-merge-of-two-strings/", "src": "https://leetcode.cn/problems/largest-merge-of-two-strings/", "solution": null, "score": 1828.6438563573, "isPremium": false}, {"id": 2904, "title": "2904. 最短且字典序最小的美丽子字符串", "slug": "/shortest-and-lexicographically-smallest-beautiful-string/", "src": "https://leetcode.cn/problems/shortest-and-lexicographically-smallest-beautiful-string/", "solution": null, "score": 1483.3041242255, "isPremium": false}, {"id": 3213, "title": "3213. 最小代价构造字符串", "slug": "/construct-string-with-minimum-cost/", "src": "https://leetcode.cn/problems/construct-string-with-minimum-cost/", "solution": null, "score": 2170.7313528632, "isPremium": false}, {"id": 1044, "title": "1044. 最长重复子串", "slug": "/longest-duplicate-substring/", "src": "https://leetcode.cn/problems/longest-duplicate-substring/", "solution": null, "score": 2428.7985254341, "isPremium": false}, {"id": 718, "title": "718. 最长重复子数组", "slug": "/maximum-length-of-repeated-subarray/", "src": "https://leetcode.cn/problems/maximum-length-of-repeated-subarray/", "solution": null, "score": null, "isPremium": false}, {"id": 1923, "title": "1923. 最长公共子路径", "slug": "/longest-common-subpath/", "src": "https://leetcode.cn/problems/longest-common-subpath/", "solution": null, "score": 2661.0670044656, "isPremium": false}, {"id": 1408, "title": "1408. 数组中的字符串匹配", "slug": "/string-matching-in-an-array/", "src": "https://leetcode.cn/problems/string-matching-in-an-array/", "solution": null, "score": 1223.3861903833, "isPremium": false}, {"id": 3076, "title": "3076. 数组中的最短非公共子字符串", "slug": "/shortest-uncommon-substring-in-an-array/", "src": "https://leetcode.cn/problems/shortest-uncommon-substring-in-an-array/", "solution": null, "score": 1635.1802054842, "isPremium": false}, {"id": 1316, "title": "1316. 不同的循环子字符串", "slug": "/distinct-echo-substrings/", "src": "https://leetcode.cn/problems/distinct-echo-substrings/", "solution": null, "score": 1836.536348078, "isPremium": false}, {"id": 3388, "title": "3388. 统计数组中的美丽分割", "slug": "/count-beautiful-splits-in-an-array/", "src": "https://leetcode.cn/problems/count-beautiful-splits-in-an-array/", "solution": null, "score": 2364.6818184488, "isPremium": false}, {"id": 2564, "title": "2564. 子字符串异或查询", "slug": "/substring-xor-queries/", "src": "https://leetcode.cn/problems/substring-xor-queries/", "solution": null, "score": 1959.2696201953, "isPremium": false}, {"id": 1698, "title": "1698. 字符串的不同子字符串个数", "slug": "/number-of-distinct-substrings-in-a-string/", "src": "https://leetcode.cn/problems/number-of-distinct-substrings-in-a-string/", "solution": null, "score": null, "isPremium": true}, {"id": 1062, "title": "1062. 最长重复子串", "slug": "/longest-repeating-substring/", "src": "https://leetcode.cn/problems/longest-repeating-substring/", "solution": null, "score": null, "isPremium": true}, {"id": 3135, "title": "3135. 通过添加或删除结尾字符来同化字符串", "slug": "/equalize-strings-by-adding-or-removing-characters-at-ends/", "src": "https://leetcode.cn/problems/equalize-strings-by-adding-or-removing-characters-at-ends/", "solution": null, "score": null, "isPremium": true}]}, {"title": "九、子序列自动机", "summary": "上面都是和**子串**相关的算法，本节是和**子序列**相关的算法：子序列自动机。<br>虽然名字有些高大上，但实际上只是预处理 $s[i]$ 右侧最近字母 $\\textit{c}$ 的下标而已。<br>", "isLeaf": true, "children": [], "problems": [{"id": 792, "title": "792. 匹配子序列的单词数", "slug": "/number-of-matching-subsequences/", "src": "https://leetcode.cn/problems/number-of-matching-subsequences/", "solution": null, "score": 1695.3076664977, "isPremium": false}, {"id": 514, "title": "514. 自由之路", "slug": "/freedom-trail/", "src": "https://leetcode.cn/problems/freedom-trail/", "solution": null, "score": null, "isPremium": false}, {"id": 2014, "title": "2014. 重复 K 次的最长子序列", "slug": "/longest-subsequence-repeated-k-times/", "src": "https://leetcode.cn/problems/longest-subsequence-repeated-k-times/", "solution": null, "score": 2558.3297484354, "isPremium": false}, {"id": 1055, "title": "1055. 形成字符串的最短路径", "slug": "/shortest-way-to-form-string/", "src": "https://leetcode.cn/problems/shortest-way-to-form-string/", "solution": null, "score": null, "isPremium": true}, {"id": 727, "title": "727. 最小窗口子序列", "slug": "/minimum-window-subsequence/", "src": "https://leetcode.cn/problems/minimum-window-subsequence/", "solution": null, "score": null, "isPremium": true}]}], "problems": []}]}